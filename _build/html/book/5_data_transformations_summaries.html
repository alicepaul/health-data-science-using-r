

<!DOCTYPE html>


<html data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>5. Data Transformations and Summaries &#8212; R for Health Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'book/5_data_transformations_summaries';</script>
    <link rel="canonical" href="https://alicepaul.github.io/r-for-health-data-science/book/5_data_transformations_summaries.html" />
    <link rel="shortcut icon" href="../_static/fav.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Merging and Reshaping Data" href="6_merging_data.html" />
    <link rel="prev" title="4. Intro to Exploratory Data Analysis" href="4_exploratory_analysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to R</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_intro_to_r.html">1. Intro to R, RStudio, and Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_data_structures.html">2. Data Structures in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_data_files.html">3. Working with Data Files in R</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exploratory Analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="4_exploratory_analysis.html">4. Intro to Exploratory Data Analysis</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Data Transformations and Summaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_merging_data.html">6. Merging and Reshaping Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_visualization_ggplot.html">7. Visualization with ggplot2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Distributions and Hypothesis Testing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="8_distributions.html">8. Probability Distributions in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_hypothesis_tests.html">9. Hypothesis Testing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Regression</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="10_linear_regression.html">10. Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_logistic_regression.html">11. Logistic Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extra Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="12_rmarkdown_reports.html">12. Writing Reports in R Markdown</a></li>

<li class="toctree-l1"><a class="reference internal" href="13_expanding_r_skills.html">13. Expanding your R Skills</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/alicepaul/r-for-health-data-science/master?urlpath=tree/book/5_data_transformations_summaries.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/alicepaul/r-for-health-data-science" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/book/5_data_transformations_summaries.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>5. Data Transformations and Summaries</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tibbles-and-data-frames">Tibbles and Data Frames</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subsetting-data">Subsetting Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practice-question">Practice Question</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#updating-rows-and-columns">Updating Rows and Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Practice Question</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summarizing-and-grouping">Summarizing and Grouping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Practice Question</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-video">Recap Video</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-transformations-and-summaries">
<h1>5. Data Transformations and Summaries<a class="headerlink" href="#data-transformations-and-summaries" title="Permalink to this headline">#</a></h1>
<p>In this chapter, we will introduce the <code class="docutils literal notranslate"><span class="pre">dyplr</span></code> package, which is part of the <code class="docutils literal notranslate"><span class="pre">tidyverse</span></code> group of packages, to expand our tools in exploring and transforming our data. We will learn how to do some basic manipulations of data (e.g. adding or removing columns, filtering data, arranging by one or multiple columns) as well as how to summarize data (e.g. grouping by values, calculating summary statistics). We will also practice combining these operations using the pipe operator <code class="docutils literal notranslate"><span class="pre">%&gt;%</span></code>. We will use the same sample of the National Health and Nutrition Examination Survey (<a class="reference external" href="https://www.cdc.gov/nchs/nhanes/index.htm">NHANES</a>) as in <a class="reference external" href="https://alicepaul.github.io/r-for-health-data-science/book/4_exploratory_analysis.html">Chapter 4</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">suppressPackageStartupMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">RforHDSdata</span><span class="p">))</span>
<span class="nf">suppressPackageStartupMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">))</span>
<span class="nf">data</span><span class="p">(</span><span class="n">NHANESsample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="tibbles-and-data-frames">
<h2>Tibbles and Data Frames<a class="headerlink" href="#tibbles-and-data-frames" title="Permalink to this headline">#</a></h2>
<p>Take a look at the class of <code class="docutils literal notranslate"><span class="pre">NHANESsample</span></code>. As we might expect, the data is stored as a data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">class</span><span class="p">(</span><span class="n">NHANESsample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'data.frame'</div></div>
</div>
<p>However, the tidyverse also works with another data structure called a <strong>tibble</strong>. A <strong>tibble</strong> has all the properties of data frames that we have learned so far, but they are a more modern version of a data frame. To convert our data to this data structure we use the <code class="docutils literal notranslate"><span class="pre">as_tibble()</span></code> function. In practice, there are only very slight difference between the two data structures, and you generally do not need to convert data frames to tibbles. Below we convert our data from a data frame to a tibble and print the head of the data before converting it back to a data frame and repeating. You can see the two structures have a slightly different print statement but are otherwise very similar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as_tibble</span><span class="p">(</span><span class="n">NHANESsample</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">nhanes_df</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># A tibble: 6 × 21
     ID   AGE SEX    RACE             EDUCATION INCOME SMOKE  YEAR  LEAD BMI_CAT
  &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;            &lt;fct&gt;      &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  
1     2    77 Male   Non-Hispanic Wh… MoreThan…   5    Neve…  1999   5   BMI&lt;=25
2     5    49 Male   Non-Hispanic Wh… MoreThan…   5    Quit…  1999   1.6 25&lt;BMI…
3    12    37 Male   Non-Hispanic Wh… MoreThan…   4.93 Neve…  1999   2.4 BMI&gt;=30
4    13    70 Male   Mexican American LessThan…   1.07 Quit…  1999   1.6 25&lt;BMI…
5    14    81 Male   Non-Hispanic Wh… LessThan…   2.67 Stil…  1999   5.5 25&lt;BMI…
6    15    38 Female Non-Hispanic Wh… MoreThan…   4.52 Stil…  1999   1.5 25&lt;BMI…
# ℹ 11 more variables: LEAD_QUANTILE &lt;fct&gt;, HYP &lt;dbl&gt;, ALC &lt;chr&gt;, DBP1 &lt;dbl&gt;,
#   DBP2 &lt;dbl&gt;, DBP3 &lt;dbl&gt;, DBP4 &lt;dbl&gt;, SBP1 &lt;dbl&gt;, SBP2 &lt;dbl&gt;, SBP3 &lt;dbl&gt;,
#   SBP4 &lt;dbl&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">nhanes_df</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">nhanes_df</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ID AGE    SEX               RACE  EDUCATION INCOME      SMOKE YEAR LEAD
1  2  77   Male Non-Hispanic White MoreThanHS   5.00 NeverSmoke 1999  5.0
2  5  49   Male Non-Hispanic White MoreThanHS   5.00  QuitSmoke 1999  1.6
3 12  37   Male Non-Hispanic White MoreThanHS   4.93 NeverSmoke 1999  2.4
4 13  70   Male   Mexican American LessThanHS   1.07  QuitSmoke 1999  1.6
5 14  81   Male Non-Hispanic White LessThanHS   2.67 StillSmoke 1999  5.5
6 15  38 Female Non-Hispanic White MoreThanHS   4.52 StillSmoke 1999  1.5
    BMI_CAT LEAD_QUANTILE HYP ALC DBP1 DBP2 DBP3 DBP4 SBP1 SBP2 SBP3 SBP4
1   BMI&lt;=25            Q4   0 Yes   58   56   56   NA  106   98   98   NA
2 25&lt;BMI&lt;30            Q3   1 Yes   82   84   82   NA  122  122  122   NA
3   BMI&gt;=30            Q4   1 Yes  108   98  100   NA  182  172  176   NA
4 25&lt;BMI&lt;30            Q3   1 Yes   78   62   70   NA  140  130  130   NA
5 25&lt;BMI&lt;30            Q4   1 Yes   56   NA   58   64  142   NA  134  138
6 25&lt;BMI&lt;30            Q3   0 Yes   68   68   70   NA  106  112  106   NA
</pre></div>
</div>
</div>
</div>
<p>We mention tibbles here since some functions in the <code class="docutils literal notranslate"><span class="pre">tidyverse</span></code> package convert data frames to tibbles in their output. In particular, when we summarize over groups below we can expect a tibble to be returned. It is useful to be aware that our data may change data structure with such functions and to know that we can always convert back if needed.</p>
</section>
<section id="subsetting-data">
<h2>Subsetting Data<a class="headerlink" href="#subsetting-data" title="Permalink to this headline">#</a></h2>
<p>In earlier chapters, we have seen how to select and filter data using row and column indices as well as using the <code class="docutils literal notranslate"><span class="pre">subset()</span></code> function. The <code class="docutils literal notranslate"><span class="pre">dplyr</span></code> package has its own functions that are useful to subset the data. The <code class="docutils literal notranslate"><span class="pre">select()</span></code> function allows us to select a subset of columns: this function takes in the data frame (or tibble) and the names or indices of the columns we want to select. For example, if we only wanted to select the variables for race and blood lead level, we could specify these two columns. To display the result of this selection, we use the pipe operator <code class="docutils literal notranslate"><span class="pre">%&gt;%</span></code>. Recall that this takes the result on the left hand side and passes it as the first argument to the function on the right hand side. The output below shows that there are only two columns in the filtered data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">select</span><span class="p">(</span><span class="n">nhanes_df</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">RACE</span><span class="p">,</span><span class="w"> </span><span class="n">LEAD</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 6 × 2</caption>
<thead>
	<tr><th></th><th scope=col>RACE</th><th scope=col>LEAD</th></tr>
	<tr><th></th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>Non-Hispanic White</td><td>5.0</td></tr>
	<tr><th scope=row>2</th><td>Non-Hispanic White</td><td>1.6</td></tr>
	<tr><th scope=row>3</th><td>Non-Hispanic White</td><td>2.4</td></tr>
	<tr><th scope=row>4</th><td>Mexican American  </td><td>1.6</td></tr>
	<tr><th scope=row>5</th><td>Non-Hispanic White</td><td>5.5</td></tr>
	<tr><th scope=row>6</th><td>Non-Hispanic White</td><td>1.5</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">select()</span></code> function can also be used to <em>remove</em> columns by adding a negative sign in front of the vector of column names in its arguments. For example, below we keep all columns except <code class="docutils literal notranslate"><span class="pre">ID</span></code> and <code class="docutils literal notranslate"><span class="pre">LEAD_QUANTILE</span></code>. Note that in this case we have saved the selected data back to our data frame <code class="docutils literal notranslate"><span class="pre">nhanes_df</span></code>. Additionally, this time we used a pipe operator to pipe the data to the select function itself.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">LEAD_QUANTILE</span><span class="p">))</span>
<span class="nf">names</span><span class="p">(</span><span class="n">nhanes_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'AGE'</li><li>'SEX'</li><li>'RACE'</li><li>'EDUCATION'</li><li>'INCOME'</li><li>'SMOKE'</li><li>'YEAR'</li><li>'LEAD'</li><li>'BMI_CAT'</li><li>'HYP'</li><li>'ALC'</li><li>'DBP1'</li><li>'DBP2'</li><li>'DBP3'</li><li>'DBP4'</li><li>'SBP1'</li><li>'SBP2'</li><li>'SBP3'</li><li>'SBP4'</li></ol>
</div></div>
</div>
<p>While <code class="docutils literal notranslate"><span class="pre">select()</span></code> allows us to choose a subset of columns, the <code class="docutils literal notranslate"><span class="pre">filter()</span></code> function allows us to choose a subset of rows.  The <code class="docutils literal notranslate"><span class="pre">filter()</span></code> function takes a data frame as the first argument and a vector of booleans as the second argument. This vector of booleans can be generated using conditional statements as we used in <a class="reference external" href="https://alicepaul.github.io/r-for-health-data-science/book/4_exploratory_analysis.html">Chapter 4</a>. Below, we choose to filter the data to only observations after 2008.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_df_recent</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="n">YEAR</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">2008</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can combine conditions by using multiple <code class="docutils literal notranslate"><span class="pre">filter</span></code> calls, by creating a more complicated conditional statement using the <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> (and), <code class="docutils literal notranslate"><span class="pre">|</span></code> (or), and <code class="docutils literal notranslate"><span class="pre">%in%</span></code> (in) operators, or by separating the conditions with commas within filter. Below, we demonstrate these three ways to filter the data to males between 2008 and 2012. Note that the <code class="docutils literal notranslate"><span class="pre">between()</span></code> function allows us to capture the logic <code class="docutils literal notranslate"><span class="pre">YEAR</span> <span class="pre">&gt;=</span> <span class="pre">2008</span> <span class="pre">&amp;</span> <span class="pre">YEAR</span> <span class="pre">&lt;=</span> <span class="pre">2012</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 1: multiple filter calls</span>
<span class="n">nhanes_df_males1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">YEAR</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">2012</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">YEAR</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">2008</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">SEX</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Male&quot;</span><span class="p">)</span>

<span class="c1"># Example 2: combine with &amp; operator</span>
<span class="n">nhanes_df_males2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">((</span><span class="n">YEAR</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">2012</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">YEAR</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">2008</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">SEX</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Male&quot;</span><span class="p">))</span>

<span class="c1"># Example 3: combine into one filter call with commas</span>
<span class="n">nhanes_df_males3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="nf">between</span><span class="p">(</span><span class="n">YEAR</span><span class="p">,</span><span class="w"> </span><span class="m">2008</span><span class="p">,</span><span class="w"> </span><span class="m">2012</span><span class="p">),</span><span class="w"> </span><span class="n">SEX</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Male&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The use of parentheses in the code above is especially important in order to capture our desired logic. In all these examples, we broke our code up into multiple lines, which makes it easier to read. A good rule of thumb is to not go past 80 characters in a line, and R Studio conveniently has a vertical gray line at this limit. To create a new line, you can hit enter either after an operator (e.g. <code class="docutils literal notranslate"><span class="pre">%&gt;%</span></code>, <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">|</span></code>) or within a set of unfinished brackets or parentheses. Either of these breaks lets R know that your code is not finished yet.</p>
<p>Lastly, we can subset the data using the <code class="docutils literal notranslate"><span class="pre">slice()</span></code> function to select a slice of rows by their index. The function takes in the data set and a vector of indices. Below, we find the first and last rows of the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">slice</span><span class="p">(</span><span class="n">nhanes_df</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">nhanes_df</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 2 × 19</caption>
<thead>
	<tr><th scope=col>AGE</th><th scope=col>SEX</th><th scope=col>RACE</th><th scope=col>EDUCATION</th><th scope=col>INCOME</th><th scope=col>SMOKE</th><th scope=col>YEAR</th><th scope=col>LEAD</th><th scope=col>BMI_CAT</th><th scope=col>HYP</th><th scope=col>ALC</th><th scope=col>DBP1</th><th scope=col>DBP2</th><th scope=col>DBP3</th><th scope=col>DBP4</th><th scope=col>SBP1</th><th scope=col>SBP2</th><th scope=col>SBP3</th><th scope=col>SBP4</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>77</td><td>Male</td><td>Non-Hispanic White</td><td>MoreThanHS</td><td>5.00</td><td>NeverSmoke</td><td>1999</td><td>5.0</td><td>BMI&lt;=25</td><td>0</td><td>Yes</td><td>58</td><td>56</td><td>56</td><td>NA</td><td>106</td><td> 98</td><td> 98</td><td>NA</td></tr>
	<tr><td>38</td><td>Male</td><td>Non-Hispanic White</td><td>MoreThanHS</td><td>1.56</td><td>StillSmoke</td><td>2017</td><td>0.9</td><td>BMI&gt;=30</td><td>1</td><td>Yes</td><td>98</td><td>92</td><td>98</td><td>NA</td><td>150</td><td>146</td><td>148</td><td>NA</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>A few other useful slice functions are <code class="docutils literal notranslate"><span class="pre">slice_sample()</span></code>, <code class="docutils literal notranslate"><span class="pre">slice_max()</span></code>, and <code class="docutils literal notranslate"><span class="pre">slice_min()</span></code>. The first takes in an argument <code class="docutils literal notranslate"><span class="pre">n</span></code> which specifies the number of <em>random</em> rows to sample from the data. For example, we could randomly sample 100 rows from our data. The latter two allow us to specify a column through the argument <code class="docutils literal notranslate"><span class="pre">order_by</span></code> and return the <code class="docutils literal notranslate"><span class="pre">n</span></code> rows with either the highest or lowest values in that column. Below we find the three male observations from 2007 with the highest and lowest blood lead levels and select a subset of columns to display.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># three male observations with highest blood lead level in 2007</span>
<span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">YEAR</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2007</span><span class="p">,</span><span class="w"> </span><span class="n">SEX</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Male&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">RACE</span><span class="p">,</span><span class="w"> </span><span class="n">EDUCATION</span><span class="p">,</span><span class="w"> </span><span class="n">SMOKE</span><span class="p">,</span><span class="w"> </span><span class="n">LEAD</span><span class="p">,</span><span class="w"> </span><span class="n">SBP1</span><span class="p">,</span><span class="w"> </span><span class="n">DBP1</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">slice_max</span><span class="p">(</span><span class="n">order_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LEAD</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>

<span class="c1"># three male observations with lowest blood lead level in 2007</span>
<span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">YEAR</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2007</span><span class="p">,</span><span class="w"> </span><span class="n">SEX</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Male&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">RACE</span><span class="p">,</span><span class="w"> </span><span class="n">EDUCATION</span><span class="p">,</span><span class="w"> </span><span class="n">SMOKE</span><span class="p">,</span><span class="w"> </span><span class="n">LEAD</span><span class="p">,</span><span class="w"> </span><span class="n">SBP1</span><span class="p">,</span><span class="w"> </span><span class="n">DBP1</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">slice_min</span><span class="p">(</span><span class="n">order_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LEAD</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 3 × 6</caption>
<thead>
	<tr><th scope=col>RACE</th><th scope=col>EDUCATION</th><th scope=col>SMOKE</th><th scope=col>LEAD</th><th scope=col>SBP1</th><th scope=col>DBP1</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Non-Hispanic Black</td><td>LessThanHS</td><td>NeverSmoke</td><td>33.1</td><td>106</td><td>66</td></tr>
	<tr><td>Other Hispanic    </td><td>LessThanHS</td><td>StillSmoke</td><td>26.8</td><td>106</td><td>72</td></tr>
	<tr><td>Other Hispanic    </td><td>LessThanHS</td><td>StillSmoke</td><td>25.7</td><td>112</td><td>60</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table class="dataframe">
<caption>A data.frame: 3 × 6</caption>
<thead>
	<tr><th scope=col>RACE</th><th scope=col>EDUCATION</th><th scope=col>SMOKE</th><th scope=col>LEAD</th><th scope=col>SBP1</th><th scope=col>DBP1</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Non-Hispanic White</td><td>LessThanHS</td><td>NeverSmoke</td><td>0.1767767</td><td>114</td><td>80</td></tr>
	<tr><td>Other Hispanic    </td><td>LessThanHS</td><td>QuitSmoke </td><td>0.2800000</td><td>122</td><td>62</td></tr>
	<tr><td>Mexican American  </td><td>MoreThanHS</td><td>QuitSmoke </td><td>0.3200000</td><td>112</td><td>66</td></tr>
</tbody>
</table>
</div></div>
</div>
<section id="practice-question">
<h3>Practice Question<a class="headerlink" href="#practice-question" title="Permalink to this headline">#</a></h3>
<p>Filter the data to only those with an education level of more than HS who report alcohol use. Then, select only the diastolic blood pressure variables and display the 4th and 10th rows. Your result should match the data below.</p>
<a class="reference internal image-reference" href="../_images/5-practicequestion1answer.png"><img alt="“”" class="align-center" src="../_images/5-practicequestion1answer.png" style="width: 200pt;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Insert your solution here:</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="updating-rows-and-columns">
<h2>Updating Rows and Columns<a class="headerlink" href="#updating-rows-and-columns" title="Permalink to this headline">#</a></h2>
<p>The next few functions we will look at will allow us to update the rows and columns in our data. For example, the <code class="docutils literal notranslate"><span class="pre">rename()</span></code> function allows us to change the names of columns. Below, we change the name of <code class="docutils literal notranslate"><span class="pre">INCOME</span></code> to <code class="docutils literal notranslate"><span class="pre">PIR</span></code> since this variable is the poverty income ratio and also update the name of <code class="docutils literal notranslate"><span class="pre">SMOKE</span></code> to be <code class="docutils literal notranslate"><span class="pre">SMOKE_STATUS</span></code>. When specifying these names, the new name is on the left of the <code class="docutils literal notranslate"><span class="pre">=</span></code> and the old name is on the right.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">rename</span><span class="p">(</span><span class="n">PIR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INCOME</span><span class="p">,</span><span class="w"> </span><span class="n">SMOKE_STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SMOKE</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">nhanes_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'AGE'</li><li>'SEX'</li><li>'RACE'</li><li>'EDUCATION'</li><li>'PIR'</li><li>'SMOKE_STATUS'</li><li>'YEAR'</li><li>'LEAD'</li><li>'BMI_CAT'</li><li>'HYP'</li><li>'ALC'</li><li>'DBP1'</li><li>'DBP2'</li><li>'DBP3'</li><li>'DBP4'</li><li>'SBP1'</li><li>'SBP2'</li><li>'SBP3'</li><li>'SBP4'</li></ol>
</div></div>
</div>
<p>In the last chapter, we created a new variable called <code class="docutils literal notranslate"><span class="pre">EVER_SMOKE</span></code> based on the smoking status variable using the <code class="docutils literal notranslate"><span class="pre">ifelse()</span></code> function. Recall that this function allows us to specify a condition and then two alternative values based on whether we meet or do not meet this condition. We see that there are about 15,000 subjects in our data who never smoked.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ifelse</span><span class="p">(</span><span class="n">nhanes_df</span><span class="o">$</span><span class="n">SMOKE_STATUS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;NeverSmoke&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;No&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Yes&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">table</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.
   No   Yes 
15087 16178 
</pre></div>
</div>
</div>
</div>
<p>Another useful function from the tidyverse is the <code class="docutils literal notranslate"><span class="pre">case_when()</span></code> function, which is an extension of the <code class="docutils literal notranslate"><span class="pre">ifelse()</span></code> function but allows to specify more than two cases. We demonstrate this function below to show how we could relabel the levels of the <code class="docutils literal notranslate"><span class="pre">SMOKE_STATUS</span></code> column. For each condition, we use the right side of the <code class="docutils literal notranslate"><span class="pre">~</span></code> to specify the value associated with a TRUE for that condition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">case_when</span><span class="p">(</span><span class="n">nhanes_df</span><span class="o">$</span><span class="n">SMOKE_STATUS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;NeverSmoke&quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Never Smoked&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="n">nhanes_df</span><span class="o">$</span><span class="n">SMOKE_STATUS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;QuitSmoke&quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Quit Smoking&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="n">nhanes_df</span><span class="o">$</span><span class="n">SMOKE_STATUS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;StillSmoke&quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Current Smoker&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">table</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.
Current Smoker   Never Smoked   Quit Smoking 
          7317          15087           8861 
</pre></div>
</div>
</div>
</div>
<p>Above, we did not store the columns we created. To do so, we could use the <code class="docutils literal notranslate"><span class="pre">$</span></code> operator or the  <code class="docutils literal notranslate"><span class="pre">cbind()</span></code> function. The tidyverse also includes an alternative function to add columns called <code class="docutils literal notranslate"><span class="pre">mutate()</span></code>. This function takes in a data frame and a set of columns with associated names to add to the data or update. In the example below, we create the column <code class="docutils literal notranslate"><span class="pre">EVER_SMOKE</span></code> and update the column <code class="docutils literal notranslate"><span class="pre">SMOKE_STATUS</span></code>. Within the <code class="docutils literal notranslate"><span class="pre">mutate()</span></code> function, we do not have to use the <code class="docutils literal notranslate"><span class="pre">$</span></code> operator to reference the column <code class="docutils literal notranslate"><span class="pre">SMOKE_STATUS</span></code>. Instead, we can specify just the column name and it will interpret it as that column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="n">EVER_SMOKE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">SMOKE_STATUS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;NeverSmoke&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;No&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Yes&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">         </span><span class="n">SMOKE_STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">case_when</span><span class="p">(</span><span class="n">SMOKE_STATUS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;NeverSmoke&quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Never Smoked&quot;</span><span class="p">,</span>
<span class="w">                                  </span><span class="n">SMOKE_STATUS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;QuitSmoke&quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Quit Smoking&quot;</span><span class="p">,</span>
<span class="w">                                  </span><span class="n">SMOKE_STATUS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;StillSmoke&quot;</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Current Smoker&quot;</span><span class="p">))</span><span class="w"> </span>
</pre></div>
</div>
</div>
</div>
<p>The last function we will demonstrate in this section is the <code class="docutils literal notranslate"><span class="pre">arrange()</span></code> function, which takes in a data frame and a vector of columns used to sort the data (data is sorted by the first column with ties being sorted by the second column, etc.). By default, the <code class="docutils literal notranslate"><span class="pre">arrange()</span></code> function sorts the data in increasing order, but we can use the <code class="docutils literal notranslate"><span class="pre">desc()</span></code> function to instead sort in descending order. For example, the code below filters the data to male smokers before sorting by decreasing systolic and diastolic blood pressure in descending order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">YEAR</span><span class="p">,</span><span class="w"> </span><span class="n">SEX</span><span class="p">,</span><span class="w"> </span><span class="n">SMOKE_STATUS</span><span class="p">,</span><span class="w"> </span><span class="n">SBP1</span><span class="p">,</span><span class="w"> </span><span class="n">DBP1</span><span class="p">,</span><span class="w"> </span><span class="n">LEAD</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">SEX</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Male&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">SMOKE_STATUS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Current Smoker&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">SBP1</span><span class="p">),</span><span class="w"> </span><span class="nf">desc</span><span class="p">(</span><span class="n">DBP1</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">head</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 10 × 6</caption>
<thead>
	<tr><th></th><th scope=col>YEAR</th><th scope=col>SEX</th><th scope=col>SMOKE_STATUS</th><th scope=col>SBP1</th><th scope=col>DBP1</th><th scope=col>LEAD</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>2011</td><td>Male</td><td>Current Smoker</td><td>230</td><td>120</td><td>5.84</td></tr>
	<tr><th scope=row>2</th><td>2015</td><td>Male</td><td>Current Smoker</td><td>230</td><td> 98</td><td>1.56</td></tr>
	<tr><th scope=row>3</th><td>2009</td><td>Male</td><td>Current Smoker</td><td>220</td><td> 80</td><td>4.84</td></tr>
	<tr><th scope=row>4</th><td>2001</td><td>Male</td><td>Current Smoker</td><td>218</td><td>118</td><td>3.70</td></tr>
	<tr><th scope=row>5</th><td>2017</td><td>Male</td><td>Current Smoker</td><td>212</td><td>122</td><td>2.20</td></tr>
	<tr><th scope=row>6</th><td>2003</td><td>Male</td><td>Current Smoker</td><td>212</td><td> 54</td><td>4.00</td></tr>
	<tr><th scope=row>7</th><td>2011</td><td>Male</td><td>Current Smoker</td><td>210</td><td> 92</td><td>5.37</td></tr>
	<tr><th scope=row>8</th><td>2007</td><td>Male</td><td>Current Smoker</td><td>210</td><td> 80</td><td>2.18</td></tr>
	<tr><th scope=row>9</th><td>2015</td><td>Male</td><td>Current Smoker</td><td>206</td><td>108</td><td>1.44</td></tr>
	<tr><th scope=row>10</th><td>2003</td><td>Male</td><td>Current Smoker</td><td>206</td><td> 68</td><td>1.80</td></tr>
</tbody>
</table>
</div></div>
</div>
<section id="id1">
<h3>Practice Question<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>Create a new column called <code class="docutils literal notranslate"><span class="pre">DBP_CHANGE</span></code> that is equal to the difference between a patient’s first and fourth diastolic blood pressure readings. Then, sort the data frame by this new column in increasing order and print the first four rows. The first four <code class="docutils literal notranslate"><span class="pre">DBP_CHANGE</span></code> values in the head of the resulting dataset should be -66, -64, -64, and -62.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Insert your solution here:                    </span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="summarizing-and-grouping">
<h2>Summarizing and Grouping<a class="headerlink" href="#summarizing-and-grouping" title="Permalink to this headline">#</a></h2>
<p>If we wanted to understand how many observations there are for each given race category, we could use the <code class="docutils literal notranslate"><span class="pre">table()</span></code> function as we described in earlier chapters. Another similar function is the <code class="docutils literal notranslate"><span class="pre">count()</span></code> function. This function takes in a data frame and one or more columns and counts the number of rows for each combination of unique values in these columns. If no columns are specified, it counts the total number of rows in the data frame. Below, we find the total number of rows (31,265) and the number of observations by race and year. We can see that the number in each group fluctuates quite a bit!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">count</span><span class="p">(</span><span class="n">nhanes_df</span><span class="p">)</span>
<span class="nf">count</span><span class="p">(</span><span class="n">nhanes_df</span><span class="p">,</span><span class="w"> </span><span class="n">RACE</span><span class="p">,</span><span class="w"> </span><span class="n">YEAR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 1 × 1</caption>
<thead>
	<tr><th scope=col>n</th></tr>
	<tr><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td>31265</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table class="dataframe">
<caption>A data.frame: 50 × 3</caption>
<thead>
	<tr><th scope=col>RACE</th><th scope=col>YEAR</th><th scope=col>n</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Mexican American  </td><td>1999</td><td> 713</td></tr>
	<tr><td>Mexican American  </td><td>2001</td><td> 674</td></tr>
	<tr><td>Mexican American  </td><td>2003</td><td> 627</td></tr>
	<tr><td>Mexican American  </td><td>2005</td><td> 634</td></tr>
	<tr><td>Mexican American  </td><td>2007</td><td> 639</td></tr>
	<tr><td>Mexican American  </td><td>2009</td><td> 672</td></tr>
	<tr><td>Mexican American  </td><td>2011</td><td> 322</td></tr>
	<tr><td>Mexican American  </td><td>2013</td><td> 234</td></tr>
	<tr><td>Mexican American  </td><td>2015</td><td> 287</td></tr>
	<tr><td>Mexican American  </td><td>2017</td><td> 475</td></tr>
	<tr><td>Other Hispanic    </td><td>1999</td><td> 181</td></tr>
	<tr><td>Other Hispanic    </td><td>2001</td><td> 129</td></tr>
	<tr><td>Other Hispanic    </td><td>2003</td><td>  80</td></tr>
	<tr><td>Other Hispanic    </td><td>2005</td><td>  96</td></tr>
	<tr><td>Other Hispanic    </td><td>2007</td><td> 395</td></tr>
	<tr><td>Other Hispanic    </td><td>2009</td><td> 367</td></tr>
	<tr><td>Other Hispanic    </td><td>2011</td><td> 337</td></tr>
	<tr><td>Other Hispanic    </td><td>2013</td><td> 167</td></tr>
	<tr><td>Other Hispanic    </td><td>2015</td><td> 214</td></tr>
	<tr><td>Other Hispanic    </td><td>2017</td><td> 313</td></tr>
	<tr><td>Non-Hispanic White</td><td>1999</td><td>1401</td></tr>
	<tr><td>Non-Hispanic White</td><td>2001</td><td>1882</td></tr>
	<tr><td>Non-Hispanic White</td><td>2003</td><td>1785</td></tr>
	<tr><td>Non-Hispanic White</td><td>2005</td><td>1818</td></tr>
	<tr><td>Non-Hispanic White</td><td>2007</td><td>1940</td></tr>
	<tr><td>Non-Hispanic White</td><td>2009</td><td>2169</td></tr>
	<tr><td>Non-Hispanic White</td><td>2011</td><td>1463</td></tr>
	<tr><td>Non-Hispanic White</td><td>2013</td><td> 917</td></tr>
	<tr><td>Non-Hispanic White</td><td>2015</td><td> 685</td></tr>
	<tr><td>Non-Hispanic White</td><td>2017</td><td>1413</td></tr>
	<tr><td>Non-Hispanic Black</td><td>1999</td><td> 463</td></tr>
	<tr><td>Non-Hispanic Black</td><td>2001</td><td> 542</td></tr>
	<tr><td>Non-Hispanic Black</td><td>2003</td><td> 576</td></tr>
	<tr><td>Non-Hispanic Black</td><td>2005</td><td> 679</td></tr>
	<tr><td>Non-Hispanic Black</td><td>2007</td><td> 728</td></tr>
	<tr><td>Non-Hispanic Black</td><td>2009</td><td> 661</td></tr>
	<tr><td>Non-Hispanic Black</td><td>2011</td><td> 876</td></tr>
	<tr><td>Non-Hispanic Black</td><td>2013</td><td> 357</td></tr>
	<tr><td>Non-Hispanic Black</td><td>2015</td><td> 351</td></tr>
	<tr><td>Non-Hispanic Black</td><td>2017</td><td> 808</td></tr>
	<tr><td>Other Race        </td><td>1999</td><td>  76</td></tr>
	<tr><td>Other Race        </td><td>2001</td><td>  88</td></tr>
	<tr><td>Other Race        </td><td>2003</td><td> 109</td></tr>
	<tr><td>Other Race        </td><td>2005</td><td> 122</td></tr>
	<tr><td>Other Race        </td><td>2007</td><td> 123</td></tr>
	<tr><td>Other Race        </td><td>2009</td><td> 175</td></tr>
	<tr><td>Other Race        </td><td>2011</td><td> 475</td></tr>
	<tr><td>Other Race        </td><td>2013</td><td> 223</td></tr>
	<tr><td>Other Race        </td><td>2015</td><td> 209</td></tr>
	<tr><td>Other Race        </td><td>2017</td><td> 595</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Finding the counts like we did above is a form of a summary statistic for our data. The <code class="docutils literal notranslate"><span class="pre">summarize()</span></code> function in the tidyverse is used to compute summary statistics of the data and allows us to compute multiple statistics: this function takes in a data frame and one or more summary functions based on the given column names. In the example below, we find the total number of observations as well as the mean and median systolic blood pressure for Non-Hispanic Blacks. Note that the <code class="docutils literal notranslate"><span class="pre">n()</span></code> function is the function within <code class="docutils literal notranslate"><span class="pre">summarize()</span></code> that finds the number of observations. In the <code class="docutils literal notranslate"><span class="pre">mean()</span></code> and <code class="docutils literal notranslate"><span class="pre">median()</span></code> functions we set <code class="docutils literal notranslate"><span class="pre">na.rm=TRUE</span></code> to remove NAs before computing these values (otherwise we could get NA as our output).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">RACE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Non-Hispanic Black&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">summarize</span><span class="p">(</span><span class="n">TOT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">n</span><span class="p">(),</span><span class="w"> </span><span class="n">MEAN_SBP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">SBP1</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span>
<span class="w">            </span><span class="n">MEAN_DBP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">DBP1</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 1 × 3</caption>
<thead>
	<tr><th scope=col>TOT</th><th scope=col>MEAN_SBP</th><th scope=col>MEAN_DBP</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>6041</td><td>128.7584</td><td>72.59694</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>If we wanted to repeat this for the other race groups, we would have to change the arguments to the <code class="docutils literal notranslate"><span class="pre">filter()</span></code> function each time. To avoid having to repeat our code and/or do this multiple times, we can use the <code class="docutils literal notranslate"><span class="pre">group_by()</span></code> function, which takes a data frame and one or more columns with which to group the data by. Below, we group using the <code class="docutils literal notranslate"><span class="pre">RACE</span></code> variable. When we look at printed output it looks almost the same as it did before except we can see that its class is now a grouped data frame, which is printed at the top. In fact, a grouped data frame (or grouped tibble) acts like a set of data frames: one for each group. If we use the <code class="docutils literal notranslate"><span class="pre">slice()</span></code> function with index 1, it will return the first row for each group.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">RACE</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">slice</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A grouped_df: 5 × 20</caption>
<thead>
	<tr><th scope=col>AGE</th><th scope=col>SEX</th><th scope=col>RACE</th><th scope=col>EDUCATION</th><th scope=col>PIR</th><th scope=col>SMOKE_STATUS</th><th scope=col>YEAR</th><th scope=col>LEAD</th><th scope=col>BMI_CAT</th><th scope=col>HYP</th><th scope=col>ALC</th><th scope=col>DBP1</th><th scope=col>DBP2</th><th scope=col>DBP3</th><th scope=col>DBP4</th><th scope=col>SBP1</th><th scope=col>SBP2</th><th scope=col>SBP3</th><th scope=col>SBP4</th><th scope=col>EVER_SMOKE</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>70</td><td><span style=white-space:pre-wrap>Male  </span></td><td><span style=white-space:pre-wrap>Mexican American  </span></td><td>LessThanHS</td><td>1.07</td><td><span style=white-space:pre-wrap>Quit Smoking  </span></td><td>1999</td><td>1.6</td><td>25&lt;BMI&lt;30</td><td>1</td><td>Yes</td><td>78</td><td>62</td><td>70</td><td>NA</td><td>140</td><td>130</td><td>130</td><td>NA</td><td>Yes</td></tr>
	<tr><td>61</td><td>Female</td><td><span style=white-space:pre-wrap>Other Hispanic    </span></td><td>MoreThanHS</td><td>3.33</td><td>Current Smoker</td><td>1999</td><td>2.2</td><td><span style=white-space:pre-wrap>BMI&lt;=25  </span></td><td>0</td><td>Yes</td><td>70</td><td>60</td><td>74</td><td>NA</td><td>106</td><td>110</td><td>116</td><td>NA</td><td>Yes</td></tr>
	<tr><td>77</td><td><span style=white-space:pre-wrap>Male  </span></td><td>Non-Hispanic White</td><td>MoreThanHS</td><td>5.00</td><td><span style=white-space:pre-wrap>Never Smoked  </span></td><td>1999</td><td>5.0</td><td><span style=white-space:pre-wrap>BMI&lt;=25  </span></td><td>0</td><td>Yes</td><td>58</td><td>56</td><td>56</td><td>NA</td><td>106</td><td> 98</td><td> 98</td><td>NA</td><td>No </td></tr>
	<tr><td>38</td><td>Female</td><td>Non-Hispanic Black</td><td><span style=white-space:pre-wrap>HS        </span></td><td>0.92</td><td>Current Smoker</td><td>1999</td><td>1.8</td><td>25&lt;BMI&lt;30</td><td>0</td><td>Yes</td><td>76</td><td>80</td><td>74</td><td>NA</td><td>116</td><td>116</td><td>114</td><td>NA</td><td>Yes</td></tr>
	<tr><td>63</td><td>Female</td><td><span style=white-space:pre-wrap>Other Race        </span></td><td>MoreThanHS</td><td>5.00</td><td><span style=white-space:pre-wrap>Never Smoked  </span></td><td>1999</td><td>1.2</td><td><span style=white-space:pre-wrap>BMI&lt;=25  </span></td><td>1</td><td>Yes</td><td>66</td><td>78</td><td>82</td><td>NA</td><td>120</td><td>118</td><td>118</td><td>NA</td><td>No </td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Grouping data is very helpful in combination with the <code class="docutils literal notranslate"><span class="pre">summarize()</span></code> function. Like with the <code class="docutils literal notranslate"><span class="pre">slice()</span></code> function, <code class="docutils literal notranslate"><span class="pre">summarize()</span></code> will calculate the summary values for each group. We can now find the total number of observations as well as the mean systolic and diastolic blood pressure values for each racial group. Note that the returned summarized data is in a tibble.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">RACE</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">summarize</span><span class="p">(</span><span class="n">TOT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">n</span><span class="p">(),</span><span class="w"> </span><span class="n">MEAN_SBP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">SBP1</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span>
<span class="w">            </span><span class="n">MEAN_DBP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">DBP1</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 5 × 4</caption>
<thead>
	<tr><th scope=col>RACE</th><th scope=col>TOT</th><th scope=col>MEAN_SBP</th><th scope=col>MEAN_DBP</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Mexican American  </td><td> 5277</td><td>124.1754</td><td>70.40122</td></tr>
	<tr><td>Other Hispanic    </td><td> 2279</td><td>123.2342</td><td>70.11270</td></tr>
	<tr><td>Non-Hispanic White</td><td>15473</td><td>124.6984</td><td>70.35830</td></tr>
	<tr><td>Non-Hispanic Black</td><td> 6041</td><td>128.7584</td><td>72.59694</td></tr>
	<tr><td>Other Race        </td><td> 2195</td><td>122.0406</td><td>72.60445</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>After summarizing, the data is no longer grouped by race. If we ever want to remove the group structure from our data, we can use the <code class="docutils literal notranslate"><span class="pre">ungroup()</span></code> function, which restores the data to a single data frame. After ungrouping by race below, we can see that we get a single observation returned by the <code class="docutils literal notranslate"><span class="pre">slice()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="n">SEX</span><span class="p">,</span><span class="w"> </span><span class="n">RACE</span><span class="p">,</span><span class="w"> </span><span class="n">SBP1</span><span class="p">,</span><span class="w"> </span><span class="n">DBP1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">RACE</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">SBP1</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">slice</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 4</caption>
<thead>
	<tr><th scope=col>SEX</th><th scope=col>RACE</th><th scope=col>SBP1</th><th scope=col>DBP1</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Female</td><td>Non-Hispanic White</td><td>270</td><td>124</td></tr>
</tbody>
</table>
</div></div>
</div>
<section id="id2">
<h3>Practice Question<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p>Create a data frame summarizing the percent of patients with hypertension by smoking status. The result should look like this:</p>
<a class="reference internal image-reference" href="../_images/5-practicequestion3answer.png"><img alt="“”" class="align-center" src="../_images/5-practicequestion3answer.png" style="width: 200pt;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Insert your solution here:</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="recap-video">
<h2>Recap Video<a class="headerlink" href="#recap-video" title="Permalink to this headline">#</a></h2>
<div class="video-container">
    <iframe width="700" height="500" src="https://www.youtube.com/embed/IeRMFCCuxwc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
</div>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<p>The following exercises use the <code class="docutils literal notranslate"><span class="pre">covidcases</span></code> dataset from the <code class="docutils literal notranslate"><span class="pre">RforHDSdata</span></code> package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">data</span><span class="p">(</span><span class="n">covidcases</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">covidcases</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'state'</li><li>'county'</li><li>'week'</li><li>'weekly_cases'</li><li>'weekly_deaths'</li></ol>
</div></div>
</div>
<ol class="arabic simple">
<li><p>Suppose we are interested in the distribution of weekly cases by state. First, create a new column in <code class="docutils literal notranslate"><span class="pre">covidcases</span></code> called <code class="docutils literal notranslate"><span class="pre">region</span></code> specifying whether each state is in the Northeast, Midwest, South, or West (you can either do this by hand using <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_regions_of_the_United_States">this list</a> of which states are in which region or you can use <a class="reference external" href="https://search.r-project.org/CRAN/refmans/usa/html/state.region.html">state.region</a> from the <code class="docutils literal notranslate"><span class="pre">datasets</span></code> package in R . Then, create a data frame summarizing the average and standard deviation of the weekly cases for the Northeast.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">covidcases</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">covidcases</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">          </span><span class="nf">mutate</span><span class="p">(</span><span class="n">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">case_when</span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Connecticut&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                 </span><span class="s">&quot;Maine&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                 </span><span class="s">&quot;Massachusetts&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                 </span><span class="s">&quot;New Hampshire&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                 </span><span class="s">&quot;Rhode Island&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                 </span><span class="s">&quot;Vermont&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                 </span><span class="s">&quot;New Jersey&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                 </span><span class="s">&quot;New York&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                 </span><span class="s">&quot;Pennsylvania&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Northeast&quot;</span><span class="p">,</span>
<span class="w">                                   </span><span class="n">state</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Illinois&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Indiana&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Michigan&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Ohio&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                               </span><span class="s">&quot;Wisconsin&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Iowa&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Kansas&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Minnesota&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Missouri&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Nebraska&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;North Dakota&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;South Dakota&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;Midwest&quot;</span><span class="p">,</span>
<span class="w">                                   </span><span class="n">state</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Delaware&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Florida&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Georgia&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Maryland&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;North Carolina&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;South Carolina&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                               </span><span class="s">&quot;Virginia&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                               </span><span class="s">&quot;District of Columbia&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;West Virginia&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Alabama&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Kentucky&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Mississippi&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Tennessee&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Arkansas&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Louisiana&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Oklahoma&quot;</span><span class="p">,</span>
<span class="w">                                               </span><span class="s">&quot;Texas&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;South&quot;</span><span class="p">,</span>
<span class="w">                                   </span><span class="n">state</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Arizona&quot;</span><span class="p">,</span>
<span class="w">                                                </span><span class="s">&quot;Colorado&quot;</span><span class="p">,</span>
<span class="w">                                                </span><span class="s">&quot;Idaho&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                </span><span class="s">&quot;Montana&quot;</span><span class="p">,</span>
<span class="w">                                                </span><span class="s">&quot;Nevada&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                </span><span class="s">&quot;New Mexico&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                </span><span class="s">&quot;Utah&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                </span><span class="s">&quot;Wyoming&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                </span><span class="s">&quot;Alaska&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                </span><span class="s">&quot;California&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                </span><span class="s">&quot;Hawaii&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                </span><span class="s">&quot;Oregon&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                </span><span class="s">&quot;Washington&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&quot;West&quot;</span><span class="p">))</span>

<span class="n">covidcases</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="nf">filter</span><span class="p">(</span><span class="n">region</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Northeast&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">summarize</span><span class="p">(</span><span class="n">avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">weekly_cases</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">weekly_cases</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 2</caption>
<thead>
	<tr><th scope=col>avg</th><th scope=col>sd</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>218.8027</td><td>1281.62</td></tr>
</tbody>
</table>
</div></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Now, create a data frame with the average and standard deviation summarized for each region rather than for just one selected region as in Question 1. Sort this data frame from highest to lowest average weekly cases. What other information would you need in order to more accurately compare these regions in terms of their average cases?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">covidcases</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">group_by</span><span class="p">(</span><span class="n">region</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">summarize</span><span class="p">(</span><span class="n">avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">weekly_cases</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span>
<span class="w">          </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">weekly_cases</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">avg</span><span class="p">))</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 4 × 3</caption>
<thead>
	<tr><th scope=col>region</th><th scope=col>avg</th><th scope=col>sd</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Northeast</td><td>218.80271</td><td>1281.6196</td></tr>
	<tr><td>West     </td><td>120.11181</td><td> 685.1325</td></tr>
	<tr><td>South    </td><td> 75.23662</td><td> 362.2401</td></tr>
	<tr><td>Midwest  </td><td> 39.28500</td><td> 203.5628</td></tr>
</tbody>
</table>
</div></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Find the ten counties in the Midwest with the lowest weekly deaths in week 15 of this data.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">covidcases</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">region</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Midwest&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">week</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">15</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">slice_min</span><span class="p">(</span><span class="n">order_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weekly_deaths</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 523 × 6</caption>
<thead>
	<tr><th scope=col>state</th><th scope=col>county</th><th scope=col>week</th><th scope=col>weekly_cases</th><th scope=col>weekly_deaths</th><th scope=col>region</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Wisconsin</td><td>Ozaukee   </td><td>15</td><td> 3</td><td>-2</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Montgomery</td><td>15</td><td> 5</td><td>-1</td><td>Midwest</td></tr>
	<tr><td>Ohio     </td><td>Clinton   </td><td>15</td><td> 7</td><td>-1</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Adams     </td><td>15</td><td>18</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Bond      </td><td>15</td><td> 1</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Bureau    </td><td>15</td><td> 2</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Calhoun   </td><td>15</td><td> 1</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Clark     </td><td>15</td><td> 4</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Clay      </td><td>15</td><td> 1</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Clinton   </td><td>15</td><td>25</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Coles     </td><td>15</td><td> 6</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Crawford  </td><td>15</td><td> 4</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Cumberland</td><td>15</td><td> 1</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>De Witt   </td><td>15</td><td> 2</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Douglas   </td><td>15</td><td> 1</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Franklin  </td><td>15</td><td> 2</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Fulton    </td><td>15</td><td>-1</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Gallatin  </td><td>15</td><td> 1</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Greene    </td><td>15</td><td>-1</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Grundy    </td><td>15</td><td>12</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Hancock   </td><td>15</td><td> 1</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Henry     </td><td>15</td><td> 7</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Iroquois  </td><td>15</td><td> 2</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Jefferson </td><td>15</td><td> 5</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Jersey    </td><td>15</td><td> 1</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Jo Daviess</td><td>15</td><td> 3</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Johnson   </td><td>15</td><td> 1</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Knox      </td><td>15</td><td> 1</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Lawrence  </td><td>15</td><td> 2</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>Illinois </td><td>Lee       </td><td>15</td><td> 7</td><td> 0</td><td>Midwest</td></tr>
	<tr><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr>
	<tr><td>Wisconsin</td><td>Dunn       </td><td>15</td><td> 3</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Eau Claire </td><td>15</td><td>21</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Florence   </td><td>15</td><td> 2</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Green      </td><td>15</td><td> 9</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Green Lake </td><td>15</td><td> 1</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Iowa       </td><td>15</td><td> 1</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Jefferson  </td><td>15</td><td> 8</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>La Crosse  </td><td>15</td><td> 3</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Lafayette  </td><td>15</td><td> 2</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Manitowoc  </td><td>15</td><td> 4</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Marinette  </td><td>15</td><td> 1</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Marquette  </td><td>15</td><td> 2</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Menominee  </td><td>15</td><td> 1</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Monroe     </td><td>15</td><td> 3</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Oconto     </td><td>15</td><td> 2</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Oneida     </td><td>15</td><td> 1</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Pierce     </td><td>15</td><td> 7</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Polk       </td><td>15</td><td> 2</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Portage    </td><td>15</td><td> 4</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Price      </td><td>15</td><td> 1</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Richland   </td><td>15</td><td> 3</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Rusk       </td><td>15</td><td> 3</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Sawyer     </td><td>15</td><td> 1</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Shawano    </td><td>15</td><td> 2</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>St. Croix  </td><td>15</td><td> 3</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Trempealeau</td><td>15</td><td> 1</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Vilas      </td><td>15</td><td> 4</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Washburn   </td><td>15</td><td> 1</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Waushara   </td><td>15</td><td> 1</td><td>0</td><td>Midwest</td></tr>
	<tr><td>Wisconsin</td><td>Wood       </td><td>15</td><td> 2</td><td>0</td><td>Midwest</td></tr>
</tbody>
</table>
</div></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Filter the data to between weeks 9 and 20 (around the start of the pandemic), get the total cases per county during that time frame, and then find the county in each state that had the highest number of total cases.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">covidcases</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="nf">between</span><span class="p">(</span><span class="n">week</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="n">county</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">summarize</span><span class="p">(</span><span class="n">total_cases</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">weekly_cases</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">slice_max</span><span class="p">(</span><span class="n">order_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_cases</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`summarise()` has grouped output by &#39;state&#39;. You can override using the
`.groups` argument.
</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A grouped_df: 51 × 3</caption>
<thead>
	<tr><th scope=col>state</th><th scope=col>county</th><th scope=col>total_cases</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td>Alabama             </td><td>Mobile              </td><td>  1474</td></tr>
	<tr><td>Alaska              </td><td>Fairbanks North Star</td><td>   234</td></tr>
	<tr><td>Arizona             </td><td>Maricopa            </td><td>  6610</td></tr>
	<tr><td>Arkansas            </td><td>Lincoln             </td><td>   801</td></tr>
	<tr><td>California          </td><td>Los Angeles         </td><td> 32919</td></tr>
	<tr><td>Colorado            </td><td>Denver              </td><td>  4227</td></tr>
	<tr><td>Connecticut         </td><td>Fairfield           </td><td> 11908</td></tr>
	<tr><td>Delaware            </td><td>Sussex              </td><td>  3171</td></tr>
	<tr><td>District of Columbia</td><td>District of Columbia</td><td>  6459</td></tr>
	<tr><td>Florida             </td><td>Miami-Dade          </td><td> 14377</td></tr>
	<tr><td>Georgia             </td><td>Fulton              </td><td>  3376</td></tr>
	<tr><td>Hawaii              </td><td>Honolulu            </td><td>   340</td></tr>
	<tr><td>Idaho               </td><td>Ada                 </td><td>   686</td></tr>
	<tr><td>Illinois            </td><td>Cook                </td><td> 56539</td></tr>
	<tr><td>Indiana             </td><td>Marion              </td><td>  7418</td></tr>
	<tr><td>Iowa                </td><td>Polk                </td><td>  2784</td></tr>
	<tr><td>Kansas              </td><td>Finney              </td><td>  1293</td></tr>
	<tr><td>Kentucky            </td><td>Jefferson           </td><td>  1918</td></tr>
	<tr><td>Louisiana           </td><td>Jefferson           </td><td>  6329</td></tr>
	<tr><td>Maine               </td><td>Cumberland          </td><td>   750</td></tr>
	<tr><td>Maryland            </td><td>Prince George's     </td><td> 10848</td></tr>
	<tr><td>Massachusetts       </td><td>Middlesex           </td><td> 16873</td></tr>
	<tr><td>Michigan            </td><td>Wayne               </td><td> 16467</td></tr>
	<tr><td>Minnesota           </td><td>Hennepin            </td><td>  5109</td></tr>
	<tr><td>Mississippi         </td><td>Hinds               </td><td>   657</td></tr>
	<tr><td>Missouri            </td><td>St. Louis           </td><td>  3747</td></tr>
	<tr><td>Montana             </td><td>Gallatin            </td><td>   431</td></tr>
	<tr><td>Nebraska            </td><td>Douglas             </td><td>  2337</td></tr>
	<tr><td>Nevada              </td><td>Clark               </td><td>  4764</td></tr>
	<tr><td>New Hampshire       </td><td>Hillsborough        </td><td>  1549</td></tr>
	<tr><td>New Jersey          </td><td>Hudson              </td><td> 15676</td></tr>
	<tr><td>New Mexico          </td><td>McKinley            </td><td>  1621</td></tr>
	<tr><td>New York            </td><td>New York City       </td><td>166883</td></tr>
	<tr><td>North Carolina      </td><td>Mecklenburg         </td><td>  2344</td></tr>
	<tr><td>North Dakota        </td><td>Cass                </td><td>  1050</td></tr>
	<tr><td>Ohio                </td><td>Franklin            </td><td>  4098</td></tr>
	<tr><td>Oklahoma            </td><td>Oklahoma            </td><td>   948</td></tr>
	<tr><td>Oregon              </td><td>Multnomah           </td><td>   861</td></tr>
	<tr><td>Pennsylvania        </td><td>Philadelphia        </td><td> 17980</td></tr>
	<tr><td>Rhode Island        </td><td>Providence          </td><td> 17223</td></tr>
	<tr><td>South Carolina      </td><td>Richland            </td><td>  1077</td></tr>
	<tr><td>South Dakota        </td><td>Minnehaha           </td><td>  2717</td></tr>
	<tr><td>Tennessee           </td><td>Davidson            </td><td>  3963</td></tr>
	<tr><td>Texas               </td><td>Harris              </td><td>  8676</td></tr>
	<tr><td>Utah                </td><td>Salt Lake           </td><td>  3422</td></tr>
	<tr><td>Vermont             </td><td>Chittenden          </td><td>   387</td></tr>
	<tr><td>Virginia            </td><td>Fairfax             </td><td>  7269</td></tr>
	<tr><td>Washington          </td><td>King                </td><td>  6589</td></tr>
	<tr><td>West Virginia       </td><td>Jackson             </td><td>   261</td></tr>
	<tr><td>Wisconsin           </td><td>Milwaukee           </td><td>  4378</td></tr>
	<tr><td>Wyoming             </td><td>Teton               </td><td>   191</td></tr>
</tbody>
</table>
</div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./book"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="4_exploratory_analysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">4. Intro to Exploratory Data Analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="6_merging_data.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">6. Merging and Reshaping Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tibbles-and-data-frames">Tibbles and Data Frames</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subsetting-data">Subsetting Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practice-question">Practice Question</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#updating-rows-and-columns">Updating Rows and Columns</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Practice Question</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summarizing-and-grouping">Summarizing and Grouping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Practice Question</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-video">Recap Video</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alice Paul
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>