

<!DOCTYPE html>


<html lang="en" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>8. Probability Distributions in R &#8212; R for Health Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'book/8_distributions';</script>
    <link rel="canonical" href="https://alicepaul.github.io/health-data-science-in-r/book/8_distributions.html" />
    <link rel="shortcut icon" href="../_static/fav.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9. Hypothesis Testing" href="9_hypothesis_tests.html" />
    <link rel="prev" title="7. Visualization with ggplot2" href="7_visualization_ggplot.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to R</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_intro_to_r.html">1. Intro to R, RStudio, and Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_data_structures.html">2. Data Structures in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_data_files.html">3. Working with Data Files in R</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exploratory Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="4_exploratory_analysis.html">4. Intro to Exploratory Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_data_transformations_summaries.html">5. Data Transformations and Summaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_merging_data.html">6. Merging and Reshaping Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_visualization_ggplot.html">7. Visualization with ggplot2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Distributions and Hypothesis Testing</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">8. Probability Distributions in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_hypothesis_tests.html">9. Hypothesis Testing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Regression</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="10_linear_regression.html">10. Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_logistic_regression.html">11. Logistic Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extra Topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="12_rmarkdown_reports.html">12. Writing Reports in R Markdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_expanding_r_skills.html">13. Expanding your R Skills</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/alicepaul/health-data-science-in-r/master?urlpath=tree/book/8_distributions.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/alicepaul/health-data-science-in-r" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/book/8_distributions.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>8. Probability Distributions in R</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Probability Distributions in R</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#random-samples">Random Samples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#density-function">Density Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cumulative-distribution">Cumulative Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quantile-distribution">Quantile Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-list-for-probability-distributions">Reference List for Probability Distributions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practice-question">Practice Question</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#empirical-distributions-and-sampling-data">Empirical Distributions and Sampling Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Practice Question</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-video">Recap Video</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="probability-distributions-in-r">
<h1>8. Probability Distributions in R<a class="headerlink" href="#probability-distributions-in-r" title="Permalink to this heading">#</a></h1>
<p>In this chapter, we will cover how to generate random samples in R from known probability distributions and empirical distributions. All of the common probability distributions have a set of four functions in base R that can be used to generate random samples and to calculate the corresponding density, quantile, and cumulative functions that correspond to that distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">suppressPackageStartupMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">))</span>
<span class="nf">suppressPackageStartupMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">HDSinRdata</span><span class="p">))</span>
<span class="nf">data</span><span class="p">(</span><span class="n">NHANESsample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Below, we demonstrate an example of drawing random samples. Anytime we do something in R in which the outcome has some randomness, we are using R’s random number generator under the hood. This means that the results will change every time we run our code. In order to make sure our code is replicable, we have to set a random seed, which makes the results the same every time. The <code class="docutils literal notranslate"><span class="pre">set.seed()</span></code> function takes in a numeric seed value. You can use any number as the seed. Below, we first sample a random value from the numbers 1 to 10 without setting a seed. Note that every time you run this code chunk, the output can change. However, in the second code chunk we set a seed, which means that the result will always be the same (in this case, it’s equal to 2).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">2</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">5</span><span class="p">)</span>
<span class="nf">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">2</div></div>
</div>
<section id="id1">
<h2>Probability Distributions in R<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>All of the common discrete (e.g. Bernoulli, binomial) and continuous (e.g. normal, uniform, exponential, poisson) probability distributions have corresponding functions in R. For each of these distributions, there are four available functions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">r[dist]()</span></code>: generates random samples from the given distribution (e.g. <code class="docutils literal notranslate"><span class="pre">rnorm()</span></code>, <code class="docutils literal notranslate"><span class="pre">runif()</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">d[dist]()</span></code>: density function for the distribution (e.g. <code class="docutils literal notranslate"><span class="pre">dnorm()</span></code>, <code class="docutils literal notranslate"><span class="pre">dunif()</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p[dist]()</span></code>: cumulative distribution function for the distribution (e.g. <code class="docutils literal notranslate"><span class="pre">pnorm()</span></code>, <code class="docutils literal notranslate"><span class="pre">punif()</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">q[dist]()</span></code>: quantile function for the distribution (e.g. <code class="docutils literal notranslate"><span class="pre">qnorm()</span></code>, <code class="docutils literal notranslate"><span class="pre">qunif()</span></code>)</p></li>
</ul>
<p>Let’s see how these work in practice, using the normal and binomial distributions as examples.</p>
<section id="random-samples">
<h3>Random Samples<a class="headerlink" href="#random-samples" title="Permalink to this heading">#</a></h3>
<p>The code below generates a sample of 100 random numbers following a normal distribution with mean 5 and standard deviation 1. As you can see, the function takes in <code class="docutils literal notranslate"><span class="pre">n</span></code> (the number of observations), <code class="docutils literal notranslate"><span class="pre">mean</span></code> (the mean with default value 0), and <code class="docutils literal notranslate"><span class="pre">sd</span></code> (the standard deviation with default value 1). A histogram plot (using the built-in <code class="docutils literal notranslate"><span class="pre">hist</span></code> function) shows that the generated values look roughly normally distributed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="m">100</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0295ad0155649d2380c5b82c25567549e564f7ddbac2d87851eef17c2128bea6.png" src="../_images/0295ad0155649d2380c5b82c25567549e564f7ddbac2d87851eef17c2128bea6.png" />
</div>
</div>
<p>We can also input a vector instead of a single value for the <code class="docutils literal notranslate"><span class="pre">mean</span></code> or <code class="docutils literal notranslate"><span class="pre">sd</span></code> arguments if we want each sample to come from its own normal distribution. As an example, below we generate 100 random numbers with the default standard deviation of 1 where half of the samples have mean 0 and the other half have mean 5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="m">100</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="m">50</span><span class="p">))</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/160a142b134f1906931fe4f40dfc730227bc6686e8ab65883c39222a088d91f0.png" src="../_images/160a142b134f1906931fe4f40dfc730227bc6686e8ab65883c39222a088d91f0.png" />
</div>
</div>
<p>For the binomial distribution, the difference is that we need to specify a probability <code class="docutils literal notranslate"><span class="pre">p</span></code> and number of trials <code class="docutils literal notranslate"><span class="pre">size</span></code> (rather than <code class="docutils literal notranslate"><span class="pre">mean</span></code> and <code class="docutils literal notranslate"><span class="pre">sd</span></code> in the normal case) to specify the distribution. Below, we generate 100 random numbers following a binomial distribution with 10 trials and probability 0.5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">rbinom</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="m">100</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/26dc4ed3b4fd8ddeba3d7020eae3881f9863a6fc4074cc2cb83156edaf816255.png" src="../_images/26dc4ed3b4fd8ddeba3d7020eae3881f9863a6fc4074cc2cb83156edaf816255.png" />
</div>
</div>
<p>We can also specify a different size or probability of success for each sample. Below, we repeat our sample but this time let the probability of success be 0.25 for half of the sample and 0.75 for the other half.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">rbinom</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="m">100</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0.25</span><span class="p">,</span> <span class="m">0.75</span><span class="p">),</span> <span class="m">50</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6d01bcec1aaff2ef92d319f7fb381ba154765968debee9b116ab0917d90fff83.png" src="../_images/6d01bcec1aaff2ef92d319f7fb381ba154765968debee9b116ab0917d90fff83.png" />
</div>
</div>
</section>
<section id="density-function">
<h3>Density Function<a class="headerlink" href="#density-function" title="Permalink to this heading">#</a></h3>
<p>Next, we look at the density function. Recall that the probability density function for a normal distribution with mean <span class="math notranslate nohighlight">\(\mu\)</span> and standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> is given by the following formula:
$<span class="math notranslate nohighlight">\( f_X(x) = \frac{1}{\sigma \sqrt{2 \pi}} \exp \left(-\frac{1}{2} \left (\frac{x-\mu}{\sigma} \right)^2 \right) \)</span>$
Below, we can compare some of the values from the <code class="docutils literal notranslate"><span class="pre">dnorm()</span></code> function to this equation and see that they are in fact equal. You can also specify the mean and standard deviation in this function. Below we use the default values (mean = 0 and sd = 1).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">dnorm</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="o">==</span> <span class="m">1</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="m">2</span><span class="o">*</span><span class="kc">pi</span><span class="p">)</span>
<span class="nf">dnorm</span><span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="o">==</span> <span class="nf">exp</span><span class="p">(</span><span class="m">-1</span><span class="o">/</span><span class="m">2</span><span class="p">)</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="m">2</span><span class="o">*</span><span class="kc">pi</span><span class="p">)</span>
<span class="nf">dnorm</span><span class="p">(</span><span class="m">2</span><span class="p">)</span> <span class="o">==</span> <span class="nf">exp</span><span class="p">(</span><span class="m">-1</span><span class="o">/</span><span class="m">2</span><span class="o">*</span><span class="m">2</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="m">2</span><span class="o">*</span><span class="kc">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">TRUE</div><div class="output text_html">TRUE</div><div class="output text_html">TRUE</div></div>
</div>
<p>If we wanted to find the density function for several values, we can input a vector to this density function. Below we find the values of the density function for a normal distribution with mean 1 and standard deviation 2 for values <code class="docutils literal notranslate"><span class="pre">c(-1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">dnorm</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">),</span> <span class="n">mean</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0.120985362259572</li><li>0.17603266338215</li><li>0.199471140200716</li><li>0.17603266338215</li><li>0.120985362259572</li></ol>
</div></div>
</div>
<p>For the binomial distribution, <code class="docutils literal notranslate"><span class="pre">dbinom()</span></code> will return the probability of a certain number of successes and corresponds to the probability density function $<span class="math notranslate nohighlight">\( P(X = x) = \binom{size}{x} p^x (1-p)^{size-x}. \)</span>$ Below, we find the probability of getting exactly 3 heads from 10 coin flips, each with a probability of 0.5 for heads.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">dbinom</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.1171875</div></div>
</div>
<p>While <code class="docutils literal notranslate"><span class="pre">dnorm()</span></code> allows us to specify any continuous values for <span class="math notranslate nohighlight">\(x\)</span>, <code class="docutils literal notranslate"><span class="pre">dbinom()</span></code> will give us a warning if <code class="docutils literal notranslate"><span class="pre">x</span></code> contains non-integer values since the support of a binomial variable only includes integers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">dbinom</span><span class="p">(</span><span class="m">2.4</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in dbinom(2.4, size = 10, p = 0.5):
“non-integer x = 2.400000”
</pre></div>
</div>
<div class="output text_html">0</div></div>
</div>
<p>We can also specify a vector for a distribution’s parameters to find the distribution function for different distributions. For example, below I find the the probability density function for <span class="math notranslate nohighlight">\(X=4\)</span> for the distribution with <span class="math notranslate nohighlight">\(p=0.25\)</span> and <span class="math notranslate nohighlight">\(p=0.5\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">dbinom</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.25</span><span class="p">,</span> <span class="m">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0.145998001098633</li><li>0.205078125</li></ol>
</div></div>
</div>
</section>
<section id="cumulative-distribution">
<h3>Cumulative Distribution<a class="headerlink" href="#cumulative-distribution" title="Permalink to this heading">#</a></h3>
<p>Next, we take a look at the cumulative distribution function. For the normal distribution, the cumulative distribution is given by <code class="docutils literal notranslate"><span class="pre">pnorm()</span></code>, which takes in a value <code class="docutils literal notranslate"><span class="pre">x</span></code>, a <code class="docutils literal notranslate"><span class="pre">mean</span></code>, and a <code class="docutils literal notranslate"><span class="pre">sd</span></code> and returns the probability that a random variable following a <span class="math notranslate nohighlight">\(N(mean, sd)\)</span> distribution is less than <code class="docutils literal notranslate"><span class="pre">x</span></code>. For example, for <code class="docutils literal notranslate"><span class="pre">x</span></code> equal to the mean, this will be a fifty percent probability because the normal distribution is symmetric with mean equal to the median. Below, we verify this for two different values of the mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">pnorm</span><span class="p">(</span><span class="m">0</span><span class="p">)</span>
<span class="nf">pnorm</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.5</div><div class="output text_html">0.5</div></div>
</div>
<p>Since the binomial distribution is discrete, it can only take on integer values from 0 to <code class="docutils literal notranslate"><span class="pre">size</span></code>. This means that, for example, the <code class="docutils literal notranslate"><span class="pre">pbinom()</span></code> function will return the same value for 3, 3.5, 3.6, all the way up to, but not including, 4 - this is because <span class="math notranslate nohighlight">\(P(X \leq 3) = P(X \leq 3.2) = P(X \leq 3.5) = P(X \leq 3.6)\)</span> and so on. Note that here we passed in a vector of values <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">pbinom</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">3.5</span><span class="p">,</span> <span class="m">3.6</span><span class="p">,</span> <span class="m">4</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0.171875</li><li>0.171875</li><li>0.171875</li><li>0.376953125</li></ol>
</div></div>
</div>
<p>We can also vary the parameters for the distribution by passing a vector for <code class="docutils literal notranslate"><span class="pre">size</span></code> and/or <code class="docutils literal notranslate"><span class="pre">p</span></code> to the cumulative distribution function. Below, we find the probability that <span class="math notranslate nohighlight">\(X \leq 3\)</span> and the probability that <span class="math notranslate nohighlight">\(X \leq 4\)</span> with 12 trials and probability 0.25 and with 10 trials and probability 0.5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">pbinom</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">4</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">12</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.25</span><span class="p">,</span> <span class="m">0.5</span><span class="p">,</span> <span class="m">0.25</span><span class="p">,</span> <span class="m">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0.648778617382049</li><li>0.171875</li><li>0.842356324195862</li><li>0.376953125</li></ol>
</div></div>
</div>
</section>
<section id="quantile-distribution">
<h3>Quantile Distribution<a class="headerlink" href="#quantile-distribution" title="Permalink to this heading">#</a></h3>
<p>Lastly, we have the quantile distribution function, which is the inverse of the cumulative distribution function. This function takes in a probability <code class="docutils literal notranslate"><span class="pre">x</span></code>, a <code class="docutils literal notranslate"><span class="pre">mean</span></code>, and a <code class="docutils literal notranslate"><span class="pre">sd</span></code> and returns the value for which the cumulative distribution function is equal to <code class="docutils literal notranslate"><span class="pre">x</span></code>. Thus, when <code class="docutils literal notranslate"><span class="pre">x</span></code> is equal to 0.5, the <code class="docutils literal notranslate"><span class="pre">qnorm()</span></code> function returns the median of the distribution, which is equal to the mean for the normal distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">qnorm</span><span class="p">(</span><span class="m">0.5</span><span class="p">)</span>
<span class="nf">qnorm</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0</div><div class="output text_html">5</div></div>
</div>
<p>For the discrete binomial distribution, the <code class="docutils literal notranslate"><span class="pre">qbinom()</span></code> function returns the largest integer value for which the probability of being less than or equal to that value is at most the inputted value x.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">qbinom</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span> <span class="m">0.3</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>2</li><li>3</li></ol>
</div></div>
</div>
</section>
<section id="reference-list-for-probability-distributions">
<h3>Reference List for Probability Distributions<a class="headerlink" href="#reference-list-for-probability-distributions" title="Permalink to this heading">#</a></h3>
<p>In the examples above, we only used the normal and binomial distributions - the other probability distributions available in R are given below. For each distribution, we have given the arguments for the <code class="docutils literal notranslate"><span class="pre">r[dist]()</span></code> function. The other three functions have a similar format. Unless otherwise stated, the parameter <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of observations.</p>
<ul class="simple">
<li><p><strong>Beta</strong>: <code class="docutils literal notranslate"><span class="pre">rbeta(n,</span> <span class="pre">shape1,</span> <span class="pre">shape2,</span> <span class="pre">ncp</span> <span class="pre">=</span> <span class="pre">0)</span></code> with shape parameters <code class="docutils literal notranslate"><span class="pre">shape1</span></code> and <code class="docutils literal notranslate"><span class="pre">shape2</span></code> (and optional non-centrality parameter <code class="docutils literal notranslate"><span class="pre">ncp</span></code>).</p></li>
<li><p><strong>Binomial</strong>: <code class="docutils literal notranslate"><span class="pre">rbinom(n,</span> <span class="pre">size,</span> <span class="pre">prob)</span></code> with probability of success <code class="docutils literal notranslate"><span class="pre">prob</span></code>  and number of trials <code class="docutils literal notranslate"><span class="pre">size</span></code></p></li>
<li><p><strong>Cauchy</strong>: <code class="docutils literal notranslate"><span class="pre">rcauchy(n,</span> <span class="pre">location</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">scale</span> <span class="pre">=</span> <span class="pre">1)</span></code> with location parameter <code class="docutils literal notranslate"><span class="pre">location</span></code> and scale parameter <code class="docutils literal notranslate"><span class="pre">scale</span></code>.</p></li>
<li><p><strong>Chi-Square</strong>: <code class="docutils literal notranslate"><span class="pre">rchisq(n,</span> <span class="pre">df,</span> <span class="pre">ncp</span> <span class="pre">=</span> <span class="pre">0)</span></code> with <code class="docutils literal notranslate"><span class="pre">df</span></code> degrees of freedom and optional non-centrality parameter <code class="docutils literal notranslate"><span class="pre">ncp</span></code>.</p></li>
<li><p><strong>Exponential</strong>: <code class="docutils literal notranslate"><span class="pre">rexp(n,</span> <span class="pre">rate</span> <span class="pre">=</span> <span class="pre">1)</span></code> with rate <code class="docutils literal notranslate"><span class="pre">rate</span></code> (i.e., mean = 1/rate).</p></li>
<li><p><strong>F</strong>: <code class="docutils literal notranslate"><span class="pre">rf(n,</span> <span class="pre">df1,</span> <span class="pre">df2,</span> <span class="pre">ncp)</span></code> with <code class="docutils literal notranslate"><span class="pre">df1</span></code> and <code class="docutils literal notranslate"><span class="pre">df2</span></code> degrees of freedom (and optional non-centrality parameter <code class="docutils literal notranslate"><span class="pre">ncp</span></code>).</p></li>
<li><p><strong>Gamma</strong>: <code class="docutils literal notranslate"><span class="pre">rgamma(n,</span> <span class="pre">shape,</span> <span class="pre">rate</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">scale</span> <span class="pre">=</span> <span class="pre">1/rate)</span></code> with parameters <code class="docutils literal notranslate"><span class="pre">shape</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span></code> (or alternatively specified by <code class="docutils literal notranslate"><span class="pre">rate</span></code>).</p></li>
<li><p><strong>Geometric</strong>: <code class="docutils literal notranslate"><span class="pre">rgeom(n,</span> <span class="pre">prob)</span></code> with probability parameter <code class="docutils literal notranslate"><span class="pre">prob</span></code>.</p></li>
<li><p><strong>Hypergeometric</strong>: <code class="docutils literal notranslate"><span class="pre">rhyper(nn,</span> <span class="pre">m,</span> <span class="pre">n,</span> <span class="pre">k)</span></code> with <code class="docutils literal notranslate"><span class="pre">m</span></code> white balls, <code class="docutils literal notranslate"><span class="pre">n</span></code> black balls, and <code class="docutils literal notranslate"><span class="pre">k</span></code> balls chosen.</p></li>
<li><p><strong>Logistic</strong>: <code class="docutils literal notranslate"><span class="pre">rlogis(n,</span> <span class="pre">location</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">scale</span> <span class="pre">=</span> <span class="pre">1)</span></code> with parameters <code class="docutils literal notranslate"><span class="pre">location</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span></code>.</p></li>
<li><p><strong>Log Normal</strong>: <code class="docutils literal notranslate"><span class="pre">rlnorm(n,</span> <span class="pre">meanlog</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">sdlog</span> <span class="pre">=</span> <span class="pre">1)</span></code> with mean <code class="docutils literal notranslate"><span class="pre">meanlog</span></code> and standard deviation <code class="docutils literal notranslate"><span class="pre">sdlog</span></code> on the log scale.</p></li>
<li><p><strong>Negative Binomial</strong>: <code class="docutils literal notranslate"><span class="pre">rnbinom(n,</span> <span class="pre">size,</span> <span class="pre">prob,</span> <span class="pre">mu)</span></code> with parameters <code class="docutils literal notranslate"><span class="pre">size</span></code> and <code class="docutils literal notranslate"><span class="pre">prob</span></code>.</p></li>
<li><p><strong>Normal</strong>: <code class="docutils literal notranslate"><span class="pre">rnorm(n,</span> <span class="pre">mean</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">sd</span> <span class="pre">=</span> <span class="pre">1)</span></code> with mean equal to <code class="docutils literal notranslate"><span class="pre">mean</span></code> and standard deviation equal to <code class="docutils literal notranslate"><span class="pre">sd</span></code>.</p></li>
<li><p><strong>Poisson</strong>: <code class="docutils literal notranslate"><span class="pre">rpois(n,</span> <span class="pre">lambda)</span></code> with parameter <code class="docutils literal notranslate"><span class="pre">lambda</span></code>.</p></li>
<li><p><strong>Student t</strong>: <code class="docutils literal notranslate"><span class="pre">rt(n,</span> <span class="pre">df,</span> <span class="pre">ncp)</span></code> with <code class="docutils literal notranslate"><span class="pre">df</span></code> degrees of freedom (and optional non-centrality parameter <code class="docutils literal notranslate"><span class="pre">ncp</span></code>).</p></li>
<li><p><strong>Uniform</strong>: <code class="docutils literal notranslate"><span class="pre">runif(n,</span> <span class="pre">min</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">max</span> <span class="pre">=</span> <span class="pre">1)</span></code> with minimum value <code class="docutils literal notranslate"><span class="pre">min</span></code> and maximum value <code class="docutils literal notranslate"><span class="pre">max</span></code>.</p></li>
<li><p><strong>Weibull</strong>: <code class="docutils literal notranslate"><span class="pre">rweibull(n,</span> <span class="pre">shape,</span> <span class="pre">scale</span> <span class="pre">=</span> <span class="pre">1)</span></code> with parameters <code class="docutils literal notranslate"><span class="pre">shape</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span></code>.</p></li>
<li><p><strong>Wilcoxon Rank Sum</strong>: <code class="docutils literal notranslate"><span class="pre">rwilcox(nn,</span> <span class="pre">m,</span> <span class="pre">n)</span></code> with <code class="docutils literal notranslate"><span class="pre">nn</span></code> number of observations and sample sizes <code class="docutils literal notranslate"><span class="pre">m</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></li>
<li><p><strong>Wilcoxon Signed Rank</strong>: <code class="docutils literal notranslate"><span class="pre">rsignrank(nn,</span> <span class="pre">n)</span></code> with <code class="docutils literal notranslate"><span class="pre">nn</span></code> number of observations and sample size <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></li>
</ul>
</section>
<section id="practice-question">
<h3>Practice Question<a class="headerlink" href="#practice-question" title="Permalink to this heading">#</a></h3>
<p>Set the random seed to be <code class="docutils literal notranslate"><span class="pre">123</span></code>, and then generate 5 random numbers following a <a class="reference external" href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/Uniform">uniform distribution</a> with min 1 and max 5. Then, find the 0.15 quantile for this same distribution (it should be equal to 1.6).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Insert your solution here:</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="empirical-distributions-and-sampling-data">
<h2>Empirical Distributions and Sampling Data<a class="headerlink" href="#empirical-distributions-and-sampling-data" title="Permalink to this heading">#</a></h2>
<p>At the start of this chapter, we used the <code class="docutils literal notranslate"><span class="pre">sample()</span></code> function. This function can also be used to sample from an empirical distribution. The <code class="docutils literal notranslate"><span class="pre">sample(x,</span> <span class="pre">size,</span> <span class="pre">replace=FALSE,</span> <span class="pre">prob=NULL)</span></code> function takes in the values we want to sample from <code class="docutils literal notranslate"><span class="pre">x</span></code>, the number of observations we want to sample <code class="docutils literal notranslate"><span class="pre">size</span></code>, and whether we want to sample with replacement <code class="docutils literal notranslate"><span class="pre">replace</span></code>. If we don’t want to sample such that each value has an equal probability of being chosen, we can also set a probability vector <code class="docutils literal notranslate"><span class="pre">prob</span></code>, which must have the same length as <code class="docutils literal notranslate"><span class="pre">x</span></code>. Below we sample 500 rows without replacement from the <code class="docutils literal notranslate"><span class="pre">NHANESsample</span></code> data. To do so, we select 500 values from the indices 1 to the number of rows in the data. We then select rows of the data using these indices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_sample_ids</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">NHANESsample</span><span class="p">),</span> <span class="m">500</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">nhanes_sample</span> <span class="o">&lt;-</span> <span class="n">NHANESsample</span><span class="p">[</span><span class="n">nhanes_sample_ids</span><span class="p">,</span> <span class="p">]</span>
<span class="nf">dim</span><span class="p">(</span><span class="n">nhanes_sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>500</li><li>21</li></ol>
</div></div>
</div>
<p>We now demonstrate sampling with replacement. By doing so, we create a new data set that is sampled from the empirical distribution of the data and that is called a <em>bootstrap sample</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_sample_ids</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">NHANESsample</span><span class="p">),</span> <span class="nf">nrow</span><span class="p">(</span><span class="n">NHANESsample</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">nhanes_sample</span> <span class="o">&lt;-</span> <span class="n">NHANESsample</span><span class="p">[</span><span class="n">nhanes_sample_ids</span><span class="p">,</span> <span class="p">]</span>
<span class="nf">dim</span><span class="p">(</span><span class="n">nhanes_sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>31265</li><li>21</li></ol>
</div></div>
</div>
<p>Another way to sample from a data frame is to use the <code class="docutils literal notranslate"><span class="pre">slice_sample()</span></code> function from the tidyverse. In this function, we can either specify the number of observations to sample <code class="docutils literal notranslate"><span class="pre">n</span></code> or the proportion of observations to sample <code class="docutils literal notranslate"><span class="pre">prop</span></code>. Additionally, we can sample with or without replacement by setting the value of the argument <code class="docutils literal notranslate"><span class="pre">replace</span></code> (with default value FALSE). We use this function below to randomly sample 20% of observations without replacement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes_sample</span> <span class="o">&lt;-</span> <span class="n">NHANESsample</span> <span class="o">%&gt;%</span>
  <span class="nf">slice_sample</span><span class="p">(</span><span class="n">prop</span> <span class="o">=</span> <span class="m">0.2</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
<span class="nf">dim</span><span class="p">(</span><span class="n">nhanes_sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>6253</li><li>21</li></ol>
</div></div>
</div>
<section id="id2">
<h3>Practice Question<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>Set the random seed to <code class="docutils literal notranslate"><span class="pre">5</span></code> and then sample 50 observations with replacement from the set of integers from 1 to 100. Take the mean of those observations - it should be 56.7.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Insert your solution here:</span>
</pre></div>
</div>
</div>
</div>
<p>Beyond sampling, we can also find the empirical cumulative distribution. That is, we can use a given vector to infer a distribution. In the case below, we draw a random sample from a normal distribution <code class="docutils literal notranslate"><span class="pre">vec</span></code> and then find its empirical cumulative distribution using the <code class="docutils literal notranslate"><span class="pre">ecdf()</span></code> function. This function actually returns a function, which can then be used to find the sample cumulative distribution for different values similar to the <code class="docutils literal notranslate"><span class="pre">p[dist]()</span></code> functions. Below, we find the sample probability that <span class="math notranslate nohighlight">\(X \leq 0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">vec</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">100</span><span class="p">)</span> 
<span class="n">ecdf_vec</span> <span class="o">&lt;-</span> <span class="nf">ecdf</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
<span class="nf">ecdf_vec</span><span class="p">(</span><span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.63</div></div>
</div>
<p>We plot this empirical distribution against the actual cdf using the <code class="docutils literal notranslate"><span class="pre">pnorm()</span></code> function below. Note that in order to do so, we create a sequence of possible <code class="docutils literal notranslate"><span class="pre">x</span></code> values to pass to both <code class="docutils literal notranslate"><span class="pre">pnorm()</span></code> and <code class="docutils literal notranslate"><span class="pre">ecdf_vec()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">-3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">0.05</span><span class="p">))</span>
<span class="n">df</span><span class="o">$</span><span class="n">ecdf</span> <span class="o">&lt;-</span> <span class="nf">ecdf_vec</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">x</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">distn</span> <span class="o">=</span> <span class="nf">pnorm</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">x</span><span class="p">)</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">+</span> 
  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ecdf</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">)</span> <span class="o">+</span> 
  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">distn</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span> <span class="s">&quot;red&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ccad13f47028f8efb6dd189d76ebc8f4219f64e56cd910e3180774fa85b9efc2.png" src="../_images/ccad13f47028f8efb6dd189d76ebc8f4219f64e56cd910e3180774fa85b9efc2.png" />
</div>
</div>
<p>In practice, the empirical cumulative distribution might involve data from a given data set that you want to use to represent the population’s distribution. As an example, below we find the empirical distribution of blood lead level from the <code class="docutils literal notranslate"><span class="pre">NHANESsample</span></code> data frame. A blood lead level of 5 µg/dL or above is considered elevated. We can see 96.4% of observations have a blood lead level below this threshold.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">ecdf_lead</span> <span class="o">&lt;-</span> <span class="nf">ecdf</span><span class="p">(</span><span class="n">nhanes_sample</span><span class="o">$</span><span class="n">LEAD</span><span class="p">)</span>
<span class="nf">ecdf_lead</span><span class="p">(</span><span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.960978730209499</div></div>
</div>
</section>
</section>
<section id="recap-video">
<h2>Recap Video<a class="headerlink" href="#recap-video" title="Permalink to this heading">#</a></h2>
<div class="video-container">
    <iframe width="700" height="500" src="https://www.youtube.com/embed/gi6nDWWRSeQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
</div></section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Assume the distribution of female heights is approximated by a normal distribution with a mean of 64 inches and a standard deviation of 2.2 inches. Using this distribution, answer the following questions.</p></li>
</ol>
<ul class="simple">
<li><p>What is the probability that a randomly chosen female is 5 feet or shorter?</p></li>
<li><p>What is the probability that a randomly chosen female is 6 feet or taller?</p></li>
<li><p>Generate 500 random observations following this distribution and find the sample 0.15 quantile. Then, compare this to the 0.15 quantile using the <code class="docutils literal notranslate"><span class="pre">qdist()</span></code> function.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Compute the probability that the height of a randomly chosen female is within 1 SD from the average height.</p></li>
</ol>
<ol class="arabic simple" start="3">
<li><p>Create a vector of 100 patient IDs, and then use the sample() function to assign half of them to a treatment group and the other half to a control group. Then, suppose those in the control group have a reduction in viral load distributed as <span class="math notranslate nohighlight">\(X \sim 100*exp(mean = V)\)</span>, where <span class="math notranslate nohighlight">\(V\)</span> follows a uniform distribution between 1 and 2, whereas those who are in the treatment group have a reduction in viral load distributed as <span class="math notranslate nohighlight">\(X \sim 100*exp(mean = 3)\)</span>. Plot distributions of reduction in viral load for both groups.</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./book"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="7_visualization_ggplot.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">7. Visualization with ggplot2</p>
      </div>
    </a>
    <a class="right-next"
       href="9_hypothesis_tests.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">9. Hypothesis Testing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Probability Distributions in R</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#random-samples">Random Samples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#density-function">Density Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cumulative-distribution">Cumulative Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quantile-distribution">Quantile Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-list-for-probability-distributions">Reference List for Probability Distributions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#practice-question">Practice Question</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#empirical-distributions-and-sampling-data">Empirical Distributions and Sampling Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Practice Question</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-video">Recap Video</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alice Paul
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>